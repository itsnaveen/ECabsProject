<!DOCTYPE html>

<html>
    <head>
        <title></title>
         <link rel="stylesheet" type="text/css" href="css/jqx.base.css"/>
        <link rel="stylesheet" type="text/css" href="css/jqx.energyblue.css"/>
        <link rel="stylesheet" type="text/css" href="css/PopUp.css" />
        <script type="text/javascript" src="Scripts/jquery-1.8.2.js"></script>
         <script type="text/javascript" src="Scripts/jquery-1.7.1.min.js"></script>
        <script type="text/javascript" src="Scripts/jqx-all.js"></script>
        <script type="text/javascript">
        $(document).ready(function () {
            $('#popupBoxClose').click(function () {
                unloadPopupBox();
            });
        });
        function unloadPopupBox() {
            $('#popup_box').fadeOut("slow");
        }
        window.setInterval(function () {
            var fp = "560078";
            var tp = "560102";
            var source = {
                type: "GET",
                url: "http://115.115.159.126/ECabs/ECabs4U.asmx/GetData?FP1=" + fp + "&FP2=" + tp,
                data: {},
                datatype: "json",
                datafields: [
                    { name: 'CustomerRequestID', type: 'long' },
                    { name: 'CustomerName', type: 'string' },   
                    { name: 'StartDate', type: 'string' },
                    { name: 'StartTime', type: 'string' },
                    { name: 'FromPostcode', type: 'string' },
                    { name: 'ToPostcode', type: 'string' },
                    { name: 'DistanceInMile', type: 'string' },
                    { name: 'DriverComments', type: 'string' }
                ],
                cache: false,
                root: 'data',
                async: false
            };
            $('#jqxgrid').bind('bindingcomplete', function (){});            
            var dataAdapter = new $.jqx.dataAdapter(source, {
                contentType: 'application/json; charset=utf-8',
                downloadComplete: function (data, textStatus, jqXHR)
                {
                    return data.d;
                }
            });
            var cellsrenderer = function (row, column, value)
            {
                return '<div style="text-align: center;">' + value + '</div>';
            }
            var columnrenderer = function (value)
            {
                return '<div style="text-align: center;">' + value + '</div>';
            }
            $("#jqxgrid").jqxGrid({
                width: '100%',
                source: dataAdapter,
                autoheight: true,
                theme: 'energyblue',
                pageable: true, 
                editable:true,
                columns: [
                    { text: 'CustomerRequestID', dataField: 'CustomerRequestID',editable:false, renderer: columnrenderer, cellsrenderer: cellsrenderer, width: 100, hidden: true },
                    { text: 'Customer name', dataField: 'CustomerName',editable:false, renderer: columnrenderer, cellsrenderer: cellsrenderer, width: 120 },  
                    { text: 'Date', dataField: 'StartDate',editable:false, renderer: columnrenderer, cellsrenderer: cellsrenderer, width: 80 },
                    { text: 'Time', dataField: 'StartTime',editable:false, renderer: columnrenderer, cellsrenderer: cellsrenderer, width: 80 },
                    { text: 'From', dataField: 'FromPostcode',editable:false, renderer: columnrenderer, cellsrenderer: cellsrenderer, width: 100 },
                    { text: 'To', dataField: 'ToPostcode',editable:false, renderer: columnrenderer, cellsrenderer: cellsrenderer, width: 100 },
                    { text: 'Distance in Mile', dataField: 'DistanceInMile',editable:false, renderer: columnrenderer, cellsrenderer: cellsrenderer, width: 120 },
                    { text: 'Fare', dataField: 'DriverComments',editable:false, renderer: columnrenderer, cellsrenderer: cellsrenderer, width: 120 },  
                    {
                        text: 'Accept', datafield: 'CustomerRequestID', columntype: 'button', renderer: columnrenderer, cellsrenderer: cellsrenderer, width: 100,
                        cellsrenderer: function ()
                        {
                            return "Accept";
                        },
                        buttonclick: function (row)
                        {
                            editrowindex = row;
                            var id = $("#jqxgrid").jqxGrid('getcellvalue', row, "CustomerRequestID");
                            alert(id);
                            alert("accepting");
                        }
                    },
                    {
                        text: 'Reject', datafield: 'DriverID', columntype: 'button', renderer: columnrenderer, cellsrenderer: cellsrenderer, width: 100,
                        cellsrenderer: function ()
                        {
                            return "Reject";
                        },
                        buttonclick: function (row)
                        {
                            editrowindex = row;
                            var id = $("#jqxgrid").jqxGrid('getcellvalue', row, "CustomerRequestID");
                            var p = $("#jqxgrid").jqxGrid('getcellvalue', row, "MobileNumber");
                            alert(id);
                           
                            alert("rejecting");
                        }
                    }
                
                ]
            });
            var renderer = function (id)
            {
                return "<input type='button' onClick='buttonclick(event)' class='gridButton' id='btn" + id + "' value='Accept'/>"
            };
            $('#popup_box').fadeIn("slow");
        }, 10000);
    </script>
    </head>
    <body>
        <div id="popup_box">
            <a id="popupBoxClose" style="cursor: pointer;">
                <img src="img/close.png" style="height: 40px; width: 40px; margin-top: -30px; margin-right:-26px;" />
            </a>
            <br />
            <div align="center" style="overflow:auto;">                
                <div id="jqxgrid"></div>
            </div>
            <br />
        </div>
    </body>
</html>
