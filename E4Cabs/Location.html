<!DOCTYPE html>
<html>
  <head>
      <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
      <meta charset="utf-8">
      <link rel="stylesheet" type="text/css" href="css/site.css" />
      <link rel="stylesheet" type="text/css" href="css/index.css" />
      <script type="text/javascript" src="Scripts/jquery-1.8.2.min.js"></script>
      <script type="text/javascript" src="Scripts/jquery.unobtrusive-ajax.min.js"></script>
      <script type="text/javascript" src="Scripts/jquery.cookie.js"></script>
      <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDAKXfZggeVZMCwQnR-mGebtLCvjuRfZcg&sensor=true"></script>
      
    <style type="text/css">
      html { height: 100% }
      body { height: 100%; margin: 0; padding: 0 }
      #map-canvas { height: 90% }
    </style>
      
    <script type="text/javascript">
        var QString = window.location.search.substring(1);
        var locFrom =  QString.split("=")[1].split("&")[0];
        var loc2 = QString.split("=")[2].split("&")[0];
        var locTo = QString.split("=")[3].split("&")[0];
        //var loc2 = "842001";
        
        var directionsDisplay, pos;
        var map;
        var latitude;
        var longitude;
        var myLocation;
        var directionsService = new google.maps.DirectionsService();
        
           function initialize() {
               var geocoder = new google.maps.Geocoder();
               var address = locFrom;
               geocoder.geocode({ 'address': address }, function (results, status) {                   
               if (status == google.maps.GeocoderStatus.OK) {
                    latitude = results[0].geometry.location.lat();
                    longitude = results[0].geometry.location.lng();
                } 
                   else {
                    alert("Request failed.")
                }
              
             directionsDisplay = new google.maps.DirectionsRenderer();         
             myLocation = new google.maps.LatLng(latitude, longitude);
                
             var mapOptions = {
               zoom:5,
               mapTypeId: google.maps.MapTypeId.ROADMAP,
               center: myLocation
             }
                   
             map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
             directionsDisplay.setMap(map);
             calcRoute();
             
            // var image = 'img/location.png';
          //   var marker = new google.maps.Marker({
          //   position: myLocation,
          //   map: map,
          //   animation: google.maps.Animation.DROP,
          //   //icon: image,
          //  //title: locFrom
          //    });
          //   google.maps.event.addListener(marker, 'click', toggleBounce);
          //  });
          //}
           
//  function toggleBounce() {
//
//    if (marker.getAnimation() != null) {
//      marker.setAnimation(null);
//    } else {
//      marker.setAnimation(google.maps.Animation.BOUNCE);
//    }
//  }
});
               }
           function calcRoute() {
             var start = locFrom;
             var end = locTo;
             var waypts = [];
               waypts.push({
                  location:loc2,
                  stopover:true})               
               
             var request = {
                 origin:start,
                 destination:end,
                 waypoints: waypts,
                 optimizeWaypoints: true,
                 travelMode: google.maps.DirectionsTravelMode.DRIVING
             };
             directionsService.route(request, function(response, status) {
               if (status == google.maps.DirectionsStatus.OK) {
                 directionsDisplay.setDirections(response);
               }
             });
           }
            google.maps.event.addDomListener(window, 'load', initialize);
        </script>
   </head>
  <body>
        <div class="header">
             <div style="float:left;height:50px;width:100px;padding-left:5px">
                <img src="img/logo1.png" class="logo"style="float:left;width:100px"/>
            </div>
           <div style="width:250px; height:50px;text-align:center;margin-right:0px">
                <div style="padding-top:13px;">
                <b class="header-font" style="color:white;font-size:16px;float:right">Cab location</b>
                </div>
            </div>
         </div>
          <div style="padding-top:50px"></div>
            <div id="map-canvas"></div>
      
  </body>
</html>