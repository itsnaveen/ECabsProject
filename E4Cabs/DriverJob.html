<!DOCTYPE html>
<html>
<head>
    <title></title>
    <link rel="stylesheet" type="text/css" href="css/index.css" />
    <link rel="stylesheet" type="text/css" href="css/site.css" />
    <link rel="stylesheet" type="text/css" href="css/PopUp.css" />

    <script src="Scripts/jquery-2.0.3.min.js"></script>
    <script type="text/javascript" src="Scripts/jquery.unobtrusive-ajax.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
    <script type="text/javascript" src="Scripts/jquery.cookie.js"></script>
    <script type="text/javascript" src="js/DriverJob.js"></script>

    <script type="text/javascript">
        var QString = window.location.search.substring(1);
        var userId = QString.split("=")[1].split("&")[0];
        var roleId = QString.split("=")[2].split("&")[0];
        var relatedId = QString.split("=")[3].split("&")[0];

        $(function () {
            $('#txtbidFare').bind('keypress', function (e) {
                if ((e.keyCode < 48 || e.keyCode > 57) && e.keyCode != 46) {
                    e.stopPropagation();
                    return false;
                }
            });

            $.ajax({
                url: 'http://115.115.159.126/ECabs/ECabs4U.asmx/checkResponse',
                type: "POST",
                datatype: "json",
                data: "{'userID':'" + relatedId + "'}",
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    var getID = data.d[0];
                    $('#hdnJobno').val(getID);
                    var getValue = data.d[1];
                    if (getValue == "False") {
                        $.ajax({
                            url: "http://115.115.159.126/ECabs/ECabs4U.asmx/GetData",
                            type: "POST",
                            dataType: "Json",
                            data: "{'userID':'" + getID + "', 'driverID':'" + relatedId + "'}",
                            contentType: "application/json; charset=utf-8",
                            success: function (data) {
                                if (data.d[0] != null) {
                                    $('#divDetails').show();
                                    $('#btnbid').show();
                                    $('#btnmap').show();
                                    $('#btncancel').show();
                                    $('#btnreject').show();
                                    $('#lbljobno').text(data.d[0]);
                                    $('#lblFromLoc').text(data.d[1]);
                                    $('#lblToLoc').text(data.d[2]);
                                    $('#lblDistance').text(data.d[5]);
                                    $('#lblpickDateDriver').text(data.d[6]);
                                    $('#lblpickTime').text(data.d[7]);
                                    $('#lblpassengercount').text(data.d[8]);
                                    $('#lbllargecase').text(data.d[9]);
                                    $('#lblsmallcase').text(data.d[10]);
                                    $('#lblwheelchair').text(data.d[11]);
                                    $('#lblchildseat').text(data.d[12]);
                                    $('#lblchildbooster').text(data.d[13]);
                                    $('#lblisReturnJourney').text(data.d[14]);

                                    $('#lblreturnTo').text(data.d[15]);
                                    $('#lblreturnFrom').text(data.d[16]);
                                    $('#lblreturnDate').text(data.d[17]);
                                    $('#lblreturnTime').text(data.d[18]);
                                    $('#otherReq').text(data.d[19]);
                                    $('#hiddenIsCabnow').val(data.d[20]);

                                    if (data.d[3] != null) {
                                        var sec = data.d[3];
                                        $('#lblpopthird').text(sec);
                                        $('#otherLoc').show();
                                        if (data.d[4] != null) {
                                            var third = data.d[4];
                                            $('#lblpopfour').text(third);
                                            $('#otherLoc').show();
                                        }
                                    }
                                    else {
                                        $('#otherLoc').hide();
                                    }
                                }
                                else {
                                    $('#divDetails').hide();
                                }
                            },
                            error: function (XMLHttpRequest, textStatus, errorThrown) {
                                $('#divDetails').hide();

                            }
                        });
                    }
                    if (data.d[0] == "Error") {
                        $('#btnRow').hide();
                        $('#divDetails').hide();
                        $('#divComplete').hide();
                        $('#btnbid').hide();
                        $('#btnmap').hide();
                        $('#btncancel').hide();
                        $('#btnreject').hide();
                        alert("You have no any job request.");
                        window.location = 'driverHome.html?id=' + userId + '&rid=' + roleId + '&rrid=' + relatedId;
                    }
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    $('#divDetails').hide();
                }
            });
            $('#popupBoxClose').click(function () {
                $('#popup_box').hide();
            });
        });

        function showJob() {            
            $("#divDealload").hide();
            $('#popup_box').fadeIn("slow");            
            $('#divDriverPop').show();
            $('#divBid').hide();
            var job = $('#lbljobno').text();
            // var customer=abc;
            var from = $('#lblFromLoc').text();
            var to = $('#lblToLoc').text();
            var third = $('#lblpopthird').text();
            var four = $('#lblpopfour').text();
            $('#lblpopjob').text(job);
            $('#lblcustomer').text("abc");
            $('#lblpopfrom').text(from);
            $('#lblpopto').text(to);
            $('#lblpopthird').text(third);
            //$('#lblpopfour').text(four);
            document.getElementById("trwheelchair").style.display = 'none';
            document.getElementById("trfare").style.display = 'none';
            document.getElementById("trchildseats").style.display = 'none';
            document.getElementById("trchildbooster").style.display = 'none';
            document.getElementById("returnFrom").style.display = 'none';
            document.getElementById("returnTo").style.display = 'none';
            document.getElementById("returnDate").style.display = 'none';
            document.getElementById("returnTime").style.display = 'none';
            document.getElementById("trOtherspec").style.display = 'none';
            document.getElementById("trSpecialtxt").style.display = 'none';
            $("#wheel").hide();
            $("#childseat").hide();
            $("#booster").hide();
            $("#other").hide();
            $("#Tr1").hide();
            $("#Tr2").hide(); $("#Tr3").hide(); $("#Tr4").hide(); $("#Tr5").hide();

        }
        
        var timereOut;
        function SubmitDeal() {
            $("#divDealload").show();
             timereOut = window.setInterval(function () {
                $("#divDealload").show();
                $('#popup_box').hide();
                $('#divDeal').hide();
                var jobNo = $('#hdnJobno').val();
                $.ajax({
                    url: "http://115.115.159.126/ECabs/ECabs4U.asmx/dealResponse",
                    type: "POST",
                    dataType: "Json",
                    data: "{'userID':'" + relatedId + "', 'jobNo':'" + jobNo + "'}",
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {
                        var getResID = data.d[0];
                        var getResponse = data.d[1];
                        var dataStatus = data.d[2];
                        var statusInfo = data.d[3];

                        if (getResponse == "False" && statusInfo == "False") {
                            $.ajax({
                                url: "http://115.115.159.126/ECabs/ECabs4U.asmx/GetDealData",
                                type: "POST",
                                dataType: "Json",
                                data: "{'userID':'" + getResID + "','driverId':'" + relatedId + "'}",
                                contentType: "application/json; charset=utf-8",
                                success: function (data) {
                                    if (data.d[0] != "Error") {
                                        //count = 1;
                                        $("#divDealload").hide();
                                        $('#popup_box').show();
                                        $('#divDeal').show();
                                        $('#lbldealjob').text(data.d[0]);
                                        $('#lbldealfrom').text(data.d[1]);
                                        $('#lbldealto').text(data.d[2]);
                                        $('#lbldealdistance').text(data.d[3]);
                                        $('#lbldealdate').text(data.d[4]);
                                        $('#lbldealtime').text(data.d[5]);
                                        $('#lbldealfare').text(data.d[6]);
                                        $('#isReturnJourney').val(data.d[7]);
                                        //DestroyMe();
                                    }
                                    else if (data.d[0] == "Error") {

                                        $('#popup_box').hide();
                                        $('#divDeal').hide();
                                        $("#divDealload").show();
                                    }
                                },
                                error: function (XMLHttpRequest, textStatus, errorThrown) {
                                }
                            });

                        }
                        else if (getResponse == "False" && statusInfo == "True") {
                            $('#divDealload').hide();
                            $('#divDetails').hide();
                            $('#btnbid').hide();
                            $('#btnmap').hide();
                            $('#btncancel').hide();
                            $('#btnreject').hide();
                            DestroyMe();
                        }
                        else if (data.d[0] == "True") {
                            DestroyMe();
                            $('#divDealload').hide();
                            $('#divDetails').hide();
                            $('#btnbid').hide();
                            $('#btnmap').hide();
                            $('#btncancel').hide();
                            $('#btnreject').hide();
                            alert('You have not been selected for this job.');
                            //UpdateStatus();

                            $.ajax({
                                url: "http://115.115.159.126/ECabs/ECabs4U.asmx/UpdateDriverStatus",
                                type: "POST",
                                dataType: "Json",
                                data: "",
                                contentType: "application/json; charset=utf-8",
                                success: function (data) {
                                    //alert(data.d);
                                },
                                error: function (XMLHttpRequest, textStatus, errorThrown) {

                                }
                            });
                            window.location = 'driverProfile.html?id=' + userId + '&rid=' + roleId + '&rrid=' + relatedId;
                        }
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {

                        $('#divDeal').hide();
                        $('#divDealload').hide();
                        $('#divDetails').hide();

                        deleteDriver();
                    }
                });
            }, 10000);

            function DestroyMe() {

                window.clearInterval(timereOut);
            }
        }

        function showSpecial() {
            $("#trfare").toggle();
            $("#trwheelchair").toggle();
            $("#trchildseats").toggle();
            $("#trchildbooster").toggle();
            $("#returnFrom").toggle();
            $("#returnTo").toggle();
            $("#returnDate").toggle();
            $("#returnTime").toggle();
            $("#trOtherspec").toggle();
            $("#trSpecialtxt").toggle();
            $("#wheel").toggle();
            $("#childseat").toggle();
            $("#booster").toggle();
            $("#other").toggle();
            $("#fare").toggle();
            $("#Tr1").toggle(); $("#Tr2").toggle(); $("#Tr3").toggle(); $("#Tr4").toggle(); $("#Tr5").toggle();
            //trfare
        }
      
        function showBid() {
            console.log('in showBid');
            $("#wheel").hide(); $("#Tr1").hide(); $("#Tr2").hide(); $("#Tr3").hide(); $("#Tr4").hide();
            $("#childseat").hide(); $("#Tr5").hide();
            $("#booster").hide();
            $("#other").hide();
            $('#divDeal').hide();
            $('#divComplete').hide();
            $('#popup_box').show();
            $('#transparent_div').show();
            $('#divDriverPop').hide();
            $('#divBid').show();
            var job = $('#lbljobno').text();
            var distance = $('#lblDistance').text();
            var from = $('#lblFromLoc').text();
            var to = $('#lblToLoc').text();
            // var third=$('#lblpopthird').text();
            // var four=$('#lblpopfour').text();
            $('#lblbidjob').text(job);
            $('#lblbiddistance').text(distance);
            $('#lblbidfrom').text(from);
            $('#lblbidto').text(to);
            var fare = $('#txtbidFare').val()
            $('#lblfare').text(fare);
            //$('#lblpopthird').text(third);
            //$('#lblpopfour').text(four);
            document.getElementById("trfare").style.display = 'table-row';
            document.getElementById("trwheelchair").style.display = 'none';
            document.getElementById("trchildseats").style.display = 'none';
            document.getElementById("trchildbooster").style.display = 'none';
            document.getElementById("trOtherspec").style.display = 'none';
            document.getElementById("trSpecialtxt").style.display = 'none';
            $("#wheel").hide();
            $("#childseat").hide();
            $("#booster").hide();
            $("#other").hide();
            $("#fare").hide();
        }

        function bidSubmit() {
            var isCabnow = $('#hiddenIsCabnow').val();
            if (isCabnow == "True") {
                var fare = $('#txtbidFare').val();
                if (fare.length <= 0) {
                    alert('Please enter fare.');
                    return false;
                }
                $("#divDealload").show();
                $("#wheel").hide(); $("#Tr1").hide(); $("#Tr2").hide(); $("#Tr3").hide(); $("#Tr4").hide(); $("#Tr5").hide();
                $("#childseat").hide();
                $("#booster").hide();
                $("#other").hide();
                $("#fare").hide();
                $('#divDriverPop').hide();
                $('#divBid').hide();
                var job = $('#lbljobno').text();
                var distance = $('#lblDistance').text();
                var from = $('#lblFromLoc').text();
                var to = $('#lblToLoc').text();
                var specialReq = $('#txtSpecialReq').val();

                $('#lblbidjob').text(job);
                $('#lblbiddistance').text(distance);
                $('#lblbidfrom').text(from);
                $('#lblbidto').text(to);

                $('#lblfare').text(fare);
                //$('#lblpopthird').text(third);
                //$('#lblpopfour').text(four);
                var rid = $('#lblbidjob').text();
                var status = true;
                var price = fare;

                $.ajax({
                    url: "http://115.115.159.126/ECabs/ECabs4U.asmx/setDriverResponse",
                    type: "POST",
                    dataType: "Json",
                    data: "{'userID':'" + relatedId + "','reqid':'" + rid + "','status':'" + status + "','price':'" + price + "','specialReq':'" + specialReq + "'}",
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {
                        //$("#divDealload").show();

                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {

                    }
                });

                document.getElementById("trfare").style.display = 'table-row';
                document.getElementById("trwheelchair").style.display = 'none';
                document.getElementById("trchildseats").style.display = 'none';
                document.getElementById("trchildbooster").style.display = 'none';
                document.getElementById("returnFrom").style.display = 'none';
                document.getElementById("returnTo").style.display = 'none';
                document.getElementById("returnDate").style.display = 'none';
                document.getElementById("returnTime").style.display = 'none';
                document.getElementById("trOtherspec").style.display = 'none';
                document.getElementById("trSpecialtxt").style.display = 'none';
                $('#popup_box').hide();
                if (fare.length > 0) {
                    SubmitDeal();
                }
            }

            else if (isCabnow == "False") {
                var fare2 = $('#txtbidFare').val();
                if (fare2.length <= 0) {
                    alert('Please enter fare.');
                    return false;
                }
                $("#wheel").hide(); $("#Tr1").hide(); $("#Tr2").hide(); $("#Tr3").hide(); $("#Tr4").hide(); $("#Tr5").hide();
                $("#childseat").hide();
                $("#booster").hide();
                $("#other").hide();
                $("#fare").hide();
                $('#divDriverPop').hide();
                $('#divBid').hide();

                $('#lblbidjob').text(job);

                $('#lblfare').text(fare2);
                var reqid = $('#lblbidjob').text();
                var statuS = true;
                var pricE = fare2;
                var specialreq = $('#txtSpecialReq').val();

                $.ajax({
                    url: "http://115.115.159.126/ECabs/ECabs4U.asmx/SetDriverResponseCabLater",
                    type: "POST",
                    dataType: "Json",
                    data: "{'userID':'" + relatedId + "','reqid':'" + reqid + "','status':'" + statuS + "','price':'" + pricE + "','specialReq':'" + specialreq + "'}",
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {
                        if (data.d == "true") {
                            alert('In progress. Awaiting customer response.');
                            window.location = 'driverProfile.html?id=' + userId + '&rid=' + roleId + '&rrid=' + relatedId;

                        }
                        else if (data.d == "false") {
                            alert('Unknown error. Please try again.');
                        }

                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {

                    }
                });
                document.getElementById("trfare").style.display = 'table-row';
                document.getElementById("trwheelchair").style.display = 'none';
                document.getElementById("trchildseats").style.display = 'none';
                document.getElementById("trchildbooster").style.display = 'none';
                document.getElementById("returnFrom").style.display = 'none';
                document.getElementById("returnTo").style.display = 'none';
                document.getElementById("returnDate").style.display = 'none';
                document.getElementById("returnTime").style.display = 'none';
                document.getElementById("trOtherspec").style.display = 'none';
                document.getElementById("trSpecialtxt").style.display = 'none';
                $('#popup_box').hide();
            }
        }

        function bidCancel() {
            $('#popup_box').hide();
            $('#divBid').hide();
            $('#transparent_div').hide();
            document.getElementById("trfare").style.display = 'none';
        }
        
        function dealSubmit() {
            window.clearInterval(timereOut);
            console.log('clearing timerout');
            $('#divDeal').hide();
            var getIsReturnJourney = $('#isReturnJourney').val();
            var getFare = $('#lbldealfare').text();
            var reqID = $('#lbldealjob').text();
            
            if (getFare == 15 || getFare > 15) {             
                if (getIsReturnJourney == "True") {
                    var _avgFare = getFare / 2;
                    if (_avgFare == 15 || _avgFare > 15) {

                        $('#divComission2').show();
                        $('#lblconfirmjob2').text(reqID);
                        $('#lblconfirmfare2').text(getFare);
                    }
                    else {
                        $('#divComission').show();
                        $('#lblconfirmjob').text(reqID);
                        $('#lblconfirmfare').text(getFare);
                        //Destroy();
                        $('#divDeal').hide();
                        $('#popup_box').hide();
                    }
                }
                else if (getIsReturnJourney == "False") {
                    $('#divDeal').hide();
                    $('#divComission').show();
                    $('#lblconfirmjob').text(reqID);
                    $('#lblconfirmfare').text(getFare);
                }
            }
            else {
                $('#divComission').hide();
                $('#divComission2').hide();
                $.ajax({
                    url: "http://115.115.159.126/ECabs/ECabs4U.asmx/jobBooked",
                    type: "POST",
                    dataType: "Json",
                    data: "{'userID':'" + relatedId + "','reqid':'" + reqID + "'}",
                    contentType: "application/json; charset=utf-8",
                    success: function () {
                        $('#divDetails').hide();
                        $('#btnbid').hide();
                        $('#btnmap').hide();
                        $('#btncancel').hide();
                        $('#btnreject').hide();
                        alert('You have been selected for this job.');
                        window.location.href = 'driverProfile.html?id=' + userId + '&rid=' + roleId + '&rrid=' + relatedId;
                    },
                });
            }
        }
        function RemoveDriverData() {
            $.ajax({
                url: "http://115.115.159.126/ECabs/ECabs4U.asmx/RemoveDriverResponse",
                type: "POST",
                dataType: "Json",
                data: "{'driverID':'" + relatedId + "'}",
                contentType: "application/json; charset=utf-8",
                success: function (data) {

                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {

                }
            });
        }
        function UpdateStatus() {
            $.ajax({
                url: "http://115.115.159.126/ECabs/ECabs4U.asmx/UpdateDriverStatus",
                type: "POST",
                dataType: "Json",
                data: "",
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    alert(data.d);
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {

                }
            });
        }

        function Confirmcomission() {
            var reqID = $('#lblconfirmjob').text();
            //var comission = 1.2;

            $.ajax({
                url: "http://115.115.159.126/ECabs/ECabs4U.asmx/jobBooked",
                type: "POST",
                dataType: "Json",
                data: "{'userID':'" + relatedId + "','reqid':'" + reqID + "'}",
                contentType: "application/json; charset=utf-8",
                success: function (data) {


                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {

                }
            });
            window.location.href = "https://sandbox.gocardless.com/pay/YH0MFHY7"; //for commission 1.2pond

            $('#divDeal').hide();
            $('#popup_box').hide();
        }

        function Confirmcomission2() {
            var reqID = $('#lblconfirmjob2').text();
            //var comission = 2.4;

            $.ajax({
                url: "http://115.115.159.126/ECabs/ECabs4U.asmx/jobBooked",
                type: "POST",
                dataType: "Json",
                data: "{'userID':'" + relatedId + "','reqid':'" + reqID + "'}",
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {

                }
            });
            window.location.href = "https://sandbox.gocardless.com/pay/GAP5Y6VH"; //for commission 2.4pond
            $('#divDeal').hide();
            $('#popup_box').hide();
        }

        function RejectComission() {
            $('#divComission').hide();
            $('#divComission2').hide();            
            var rid = $('#hdnJobno').val();
            var status = "Rejected at commission time";
            $.ajax({
                url: "http://115.115.159.126/ECabs/ECabs4U.asmx/rejectResponse",
                type: "POST",
                dataType: "Json",
                data: "{'userID':'" + relatedId + "','reqid':'" + rid + "','status':'" + status + "'}",
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    if(data.d == true)
                    {
                      console.log('rej');
                        alert('rej');
                      window.location = 'driverProfile.html?id=' + userId + '&rid=' + roleId + '&rrid=' + relatedId;
                    }
                    else
                    {
                        console.log('Exception in rejectResponse')
                    }
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {

                }
            });
        }
        function dealCancel() {
            $('#divDeal').hide();
            $('#popup_box').hide();
        }

        function btnAbort() {
            $('#popup_box').show();
            $('#divabort').show();
            $('#divComplete').hide();
        }
        
        function abortcancel() {
            $('#popup_box').hide();
            $('#divabort').hide();
            $('#divComplete').show();
        }

    </script>
</head>
<body>
    <div style="width:100%;height:70px;"  class="header">
                <table style="width:100%;padding-top:1%;">
                    <tr>
                        <td style="float:left;width:30%">
                             <div style="float:left;height:48px;width:100px;">
                                    <img src="img/logo1.png" class="logo"/>
                             </div>                              
                        </td>                        
                        <td style="float:left;padding-left:3%;width:50%">                           
                            <div style="padding-top:13px;">
                                <b class="header-font" style="color:white;font-size:16px;">Job detail</b>
                            </div>                           
                        </td>
                    </tr>
                </table>
         </div>
    <center>
        <div id="transparent_div" style="display: none"></div>
        <input type="hidden" id="hiddenIsCabnow" />
        <input type="hidden" id="hdnJobno" />
        <div id="divDealload" class="loadForall">
            <span style="font-family:'Trebuchet MS';color:white">Please wait...</span><br>
            <img src="jquery-mobile/styles/images/ajax-loader-hor.gif" style="width:140px;height:10px" /><br/>
            <input type="button" value="Cancel" onclick="reqReject()"/>
        </div>
        <div style="width:100%;height:75%;padding-top:25%;display:none;" id="divDetails">
            <div id="popup_box">
                <div id="divDriverPop" align="center" style="display:none;">
                    <table align="left" style="width:100%;background-color:#FFFFFF;">
                        <tr>
                            <td class="popup_header" style="width:100%" colspan="2">
                                <strong style="padding-left:5px;font-size:13px;width:100%;text-align:left">Job Details</strong>
                            </td>
                        </tr>

                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px;">Job Number</b>
                            </td>
                            <td style="width:70%">
                                <b> <label id="lblpopjob" style="font-size:11px;"/></b>
                            </td>
                        </tr>

                        <tr class="popup_content">
                            <td style="width: 30%">
                                <b style="font-size:11px;">Customer Name</b>
                            </td>
                            <td style="width:70%">
                                <b>  <label id="lblcustomer" style="font-size:11px;"/></b>
                            </td>
                        </tr>

                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px;">From</b>
                            </td>
                            <td style="width:70%">
                                <b>  <label id="lblpopfrom" style="font-size:11px;"/></b>
                            </td>
                        </tr>

                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px;">To</b>
                            </td>
                            <td style="width:70%">
                                <b> <label id="lblpopto" style="font-size:11px;"/></b>
                            </td>
                        </tr>

                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px;">Third Location</b>

                            </td>
                            <td style="width:70%">
                                <b><label id="lblpopthird" style="font-size:11px;" /></b>
                            </td>
                        </tr>

                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px;">Fourth Location</b>
                            </td>
                            <td style="width:70%">
                                <b><label id="lblpopfour" style="font-size:11px;"/></b>
                            </td>
                        </tr>

                        <tr style="width:100%" class="popup_footer">
                            <td style="width:100%" colspan="2">
                                <input type="button" class="ok" id="popupBoxClose" style="text-align:center;" value="OK" />
                            </td>
                        </tr>
                    </table>
                </div>

                <div id="divBid" style="display:none;" align="center">
                    <table align="left" style="width:100%;background-color:#FFFFFF;">
                        <tr>
                            <td class="popup_header" style="width:100%" colspan="2">
                                <strong style="padding-left:5px;width:100%;text-align:left">Bid Details</strong>
                            </td>
                        </tr>
                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px;">Job Number</b>
                            </td>
                            <td style="width:70%">
                                <b><label id="lblbidjob" style="font-size:11px;"/></b>
                            </td>
                        </tr>

                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px; ">From</b>
                            </td>
                            <td style="width:70%">
                                <b>  <label id="lblbidfrom" style="font-size:11px;"/></b>
                            </td>
                        </tr>

                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px;">To</b>
                            </td>
                            <td style="width:70%">
                                <b> <label id="lblbidto" style="font-size:11px;" /></b>
                            </td>
                        </tr>

                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px; ">Distance In Mile</b>
                            </td>
                            <td style="width:70%">
                                <b> <label id="lblbiddistance" style="font-size:11px;" /></b>
                            </td>
                        </tr>

                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px;">Special Requirements</b>
                            </td>
                            <td style="width:70%">
                                <b>
                                    <textarea id="txtSpecialReq" style="font-family:sans-serif;width:93%" maxlength="100"></textarea>
                                </b>
                            </td>
                        </tr>

                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px;">Fare in (&pound;)</b>
                            </td>
                            <td style="width:70%">
                                <b><input type="text" id="txtbidFare" maxlength="3" style="font-size:11px;width:95%;" /></b>
                            </td>
                        </tr>
                        <tr class="popup_footer">
                            <td style="width:50%">
                                <input type="button" class="ok" value="Accept" style="width:100%;" onclick="bidSubmit()" />
                            </td>
                            <td style="width:50%">
                                <input type="button" class="ok" value="Cancel" style="width:100%;" onclick="bidCancel()" />
                            </td>
                        </tr>
                    </table>
                </div>

                <div id="divDeal" style="display:none;" align="center">
                    <input type="hidden" id="isReturnJourney" />
                    <table align="left" style="width:100%;background-color:#FFFFFF;">
                        <tr>
                            <td class="popup_header" style="width:100%;" colspan="2">
                                <strong style="padding-left:5px;width:100%;text-align:left">Booking Details</strong>
                            </td>
                        </tr>
                        <tr class="popup_content">
                            <td style="width:100%" colspan="2">
                                <b style="font-size:11px;text-align:justify;color:blue;">Customer has accepted your request, please see details.</b>
                                <hr>
                            </td>

                        </tr>
                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px;">Job Number</b>
                            </td>
                            <td style="width:70%">
                                <b> <label id="lbldealjob" style="font-size:11px;" /></b>
                            </td>
                        </tr>

                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px;">From</b>
                            </td>
                            <td style="width:70%">
                                <b>  <label id="lbldealfrom" style="font-size:11px;" /></b>
                            </td>
                        </tr>

                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px;">To</b>
                            </td>
                            <td style="width:70%">
                                <b> <label id="lbldealto" style="font-size:11px;" /></b>
                            </td>
                        </tr>

                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px;">Pick Date</b>
                            </td>
                            <td style="width:70%">
                                <b> <label id="lbldealdate" style="font-size:11px;" /></b>
                            </td>
                        </tr>

                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px;">Pick Time</b>
                            </td>
                            <td style="width:70%">
                                <b> <label id="lbldealtime" style="font-size:11px;" /></b>
                            </td>
                        </tr>

                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px;">Distance In Mile</b>
                            </td>
                            <td style="width:70%">
                                <b> <label id="lbldealdistance" style="font-size:11px;" /></b>
                            </td>
                        </tr>

                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px;">Fare</b>
                            </td>
                            <td style="width:70%">
                                <b><img src="img/euro.png" width="10" height="10" /><label id="lbldealfare" style="font-size:11px;" /></b>
                            </td>
                        </tr>

                        <tr class="popup_footer">
                            <td style="width:100%" colspan="2">
                                <input type="button" class="ok" value="Accept" style="width:100%;" onclick="dealSubmit()" />
                            </td>
                        </tr>
                    </table>
                </div>
                <div id="divComission" style="display:none;" align="center">
                    <table align="left" style="width:100%;background-color:#FFFFFF;">
                        <tr>
                            <td class="popup_header" style="width:100%" colspan="2">
                                <strong style="padding-left:5px;width:100%;text-align:left">Commission Payment</strong>
                            </td>
                        </tr>
                        <tr class="popup_content">
                            <td style="width:100%" colspan="2">
                                <b style="font-size:12px;text-align:justify;color:blue;">Confirming will take you to the payment page, we will charge 1.2<img src="img/euro.png" width="10" height="10" /> for this job on a commission.</b>
                                <hr>
                            </td>
                        </tr>
                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px;">Job Number</b>
                            </td>
                            <td style="width:70%">
                                <b> <label id="lblconfirmjob" style="font-size:11px;" /></b>
                            </td>
                        </tr>
                        <tr class="popup_content">
                            <td style="width: 30%">
                                <b style="font-size:11px;">Fare</b>
                            </td>
                            <td style="width:70%">
                                <b>
                                    <img src="img/euro.png" width="10" height="10"/>
                                    <label id="lblconfirmfare" style="font-size:11px; " />
                                </b>
                            </td>
                        </tr>
                        <tr class="popup_footer">
                            <td style="width: 50%">
                                <input type="button" value="Proceed" class="ok" onclick="Confirmcomission()" />                                
                            </td>
                            <td style="width:50%">
                                <input type="button" value="Reject" class="ok" onclick="RejectComission()" />
                            </td>
                        </tr>
                    </table>
                </div>

                <!--Commission fare for return journey pop up box-->

                <div id="divComission2" style="display:none;" align="center">
                    <table align="left" style="width:100%;background-color:#FFFFFF;">
                        <tr>
                            <td class="popup_header" style="width:100%" colspan="2">
                                <strong style="padding-left:5px;width:100%;text-align:left">Commission Payment</strong>
                            </td>
                        </tr>
                        <tr class="popup_content">
                            <td style="width:100%" colspan="2">
                                <b style="font-size:12px;text-align:justify;color:blue;">Confirming will take you to the payment page, we will charge 2.4<img src="img/euro.png" width="10" height="10" /> for this job on a commission.</b>
                                <hr>
                            </td>
                        </tr>
                        <tr class="popup_content">
                            <td style="width:30%">
                                <b style="font-size:11px;">Job Number</b>
                            </td>
                            <td style="width:70%">
                                <b> <label id="lblconfirmjob2" style="font-size:11px;" /></b>
                            </td>
                        </tr>
                        <tr class="popup_content">
                            <td style="width: 30%">
                                <b style="font-size:11px;">Fare</b>
                            </td>
                            <td style="width:70%">
                                <b><img src="img/euro.png" width="10" height="10"/><label id="lblconfirmfare2" style="font-size:11px;"/></b>
                            </td>
                        </tr>
                        <tr class="popup_footer">
                            <td style="width:50%">
                                <input type="button" value="Proceed" class="ok" onclick="Confirmcomission2()" />
                            </td>
                            <td style="width:50%">
                                <input type="button" value="Reject" class="ok" onclick="RejectComission()" />
                            </td>
                        </tr>
                    </table>
                </div>

                <div id="divabort" style="display:none;" align="center">
                    <table align="left" style="width:100%;background-color:#FFFFFF;">
                        <tr>
                            <td class="popup_header" style="width:100%" colspan="2">
                                <strong style="padding-left:5px;width:100%;text-align:left">Reason</strong>
                            </td>
                        </tr>
                        <tr class="popup_content">
                            <td style="width:100%" colspan="2">
                                <input type="text" id="txtreason" style="width:80%" />
                            </td>

                        </tr>
                        <tr class="popup_footer">
                            <td style="width:50%">
                                <input type="button" id="ok" class="ok" value="OK" style="width:80%;" onclick="abortOk()" />

                            </td>
                            <td style="width:50%">
                                <input type="button" class="ok" value="Cancel" style="width:80%;" onclick="abortcancel()" />
                            </td>
                        </tr>
                    </table>
                </div>
            </div>        


            <table id="tbdetails" style="border-collapse:collapse;padding-bottom:50px;width:100%">
                <tr>
                    <td style="width:40%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label><b style="font-size:13px;" class="">Job Number</b></label>
                    </td>
                    <td style="width:60%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <a href="#" onclick="showJob()" style="color:blue;">
                            <b style="font-size:13px;">
                                <label id="lbljobno"></label>
                            </b>
                        </a>
                    </td>
                </tr>
                <tr>
                    <td style="width:40%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label><b style="font-size:11px;" class="">From</b></label>
                    </td>
                    <td style="width:60%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <b style="font-size:11px;" class=""> <label id="lblFromLoc" /></b>
                    </td>
                </tr>
                <tr>
                    <td style="width:40%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label><b style="font-size:11px;" class="">To </b></label>

                    </td>
                    <td style="width:60%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <b style="font-size:11px" class=""> <label id="lblToLoc"></label></b>
                    </td>
                </tr>
                <tr>
                    <td style="width:40%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label><b style="font-size:11px;" class="">Distance In Miles </b></label>

                    </td>
                    <td style="width:60%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <b style="font-size:11px;" class="">  <label id="lblDistance" /></b>
                    </td>
                <tr>
                    <td style="width:40%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label><b style="font-size:11px;" class="">Pick Up Date </b></label>

                    </td>
                    <td style="width:60%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <b style="font-size:11px; " class=""><label id="lblpickDateDriver" /></b>
                    </td>
                <tr>
                    <td style="width:40%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label><b style="font-size:11px;" class="">Pick Up Time </b></label>
                    </td>
                    <td style="width:60%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <b style="font-size:11px;" class=""><label id="lblpickTime" /></b>
                    </td>

                <tr>
                    <td style="width:40%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label><b style="font-size:11px;" class="test">Passenger</b></label>

                    </td>
                    <td style="width:60%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <b style="font-size:13px;" class="test"><label id="lblpassengercount" /></b>
                    </td>
                <tr>
                    <td style="width:40%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label><b style="font-size:11px; " class="test">Large Case </b></label>
                    </td>
                    <td style="width:60%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <b style="font-size:11px;" class=""> <label id="lbllargecase" /> </b>

                    </td>

                <tr>
                    <td style="width:40%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label><b style="font-size:11px" class="test">Small Case </b></label>

                    </td>
                    <td style="width:60%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <b style="font-size:11px" class=""><label id="lblsmallcase" /></b>

                    </td>
                </tr>
                <tr>
                    <td style="width:40%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label><b style="font-size:11px;" class="">Is Return Journey</b></label>
                    </td>
                    <td style="width:60%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <b style="font-size:11px" class=""><label id="lblisReturnJourney" /> </b>
                    </td>
                </tr>

                <tr id="trfare" style="display:none">
                    <td style="width:40%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label><b style="font-size:11px" class="">Fare </b></label>
                    </td>
                    <td style="width:60%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <b style="font-size:13px" class=""><img src="img/euro.png" width="10" height="10" /><label id="lblfare" /></b>
                    </td>
                </tr>
                <tr>
                    <td style="width:40%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label><b style="font-size:11px" class="">Special Requirement </b></label>

                    </td>
                    <td style="width:60%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <b style="font-size:11px" class=""> <label id="specialReq"><a href="#" onclick="showSpecial()" style="color:blue;">Show</a> </label></b>
                    </td>
                </tr>
               
                <tr id="trwheelchair" style="display:none;">
                    <td style="width:40%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label><b style="font-size:11px" class="">Wheelchair Passengers </b></label>
                    </td>
                    <td style="width:60%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label> <b style="font-size:11px" class=""><label id="lblwheelchair" /></b></label>
                    </td>
                </tr>
              
                <tr id="trchildseats" style="display:none;">
                    <td style="width:40%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label><b style="font-size:11px" class="">Child Seats</b></label>
                    </td>
                    <td style="width:60%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <b style="font-size:11px" class=""><label id="lblchildseat" />  </b>
                    </td>
                </tr>
               
                <tr id="trchildbooster" style="display:none;">
                    <td style="width:40%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label><b style="font-size:11px" class="">Child Booster </b></label>

                    </td>
                    <td style="width:60%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <b style="font-size:11px">
                            <label id="lblchildbooster" class="" />
                        </b>
                    </td>
                </tr>
               
                <tr id="returnFrom" style="display:none;">
                    <td style="width:40%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label><b style="font-size:11px" class="">Return From </b></label>
                    </td>
                    <td style="width:60%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <b style="font-size:11px">
                            <label id="lblreturnFrom" class="" />
                        </b>
                    </td>
                </tr>
              
                <tr id="returnTo" style="display:none;">
                    <td style="width:40%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label class="font-style"><b style="font-size:13px" class="test">Return To </b></label>
                    </td>
                    <td style="width:60%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <b style="font-size:11px">
                            <label id="lblreturnTo" class="" />
                        </b>
                    </td>
                </tr>
              
                <tr id="returnDate" style="display:none;">
                    <td style="width:40%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label><b style="font-size:11px" class="">Return Date </b></label>
                    </td>
                    <td style="width:60%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <b style="font-size:11px">
                            <label id="lblreturnDate" class="" />
                        </b>
                    </td>
                </tr>
               
                <tr id="returnTime" style="display:none;">
                    <td style="width:40%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <label><b style="font-size:11px" class="">Return Time </b></label>
                    </td>
                    <td style="width:60%;border-bottom:1px solid #848484;padding-bottom:4px">
                        <b style="font-size:11px">
                            <label id="lblreturnTime" class="" />
                        </b>
                    </td>
                </tr>

                <tr id="trOtherspec" style="display:none;">
                    <td style="width:100%;border-bottom:1px solid #848484;padding-bottom:4px" colspan="2">
                        <label><b style="font-size:11px" class="">Other Requirements</b></label>
                    </td>
                </tr>
                <tr id="trSpecialtxt" style="display:none;">
                    <td style="width:100%;border-bottom:1px solid #848484;padding-bottom:4px" colspan="2">
                        <label id="otherReq"></label>
                    </td>
                </tr>
            </table>
        </div>
    </center>

    <table style="width: 100%; position: fixed; bottom: 0px;padding-bottom: 15%">
        <tr>
            <td style="width:25%">
                <input type="button" id="btnbid" class="specialBtn" onclick="showBid()" style="width: 100%; display: none" value="Bid" />
            </td>
            <td style="width:25%">
                <input type="button" id="btnmap" class="specialBtn" onclick="showMap()" style="width: 100%; display: none" value="Map" />
            </td>
            <td style="width:25%">
                <input type="button" id="btnreject" class="specialBtn" onclick="reqReject()" style="width: 100%; display: none" value="Reject" />
            </td>
        </tr>
    </table>

        <div class="btn-tmpFooter">                
               <table style="width:100%;border-collapse:collapse" >
                    <tr>
                        <td style="width:17%">
                            <div style="padding-top:5px">
                                <img src="img/Home.png" style="height:20px;" onclick="HomePage()"/><br/>Home
                            </div>
                        </td>
                        <td style="width:17%">
                             <div style="padding-top:5px">
                                <img src="img/User.png" style="height:20px;" onclick="MyProfilePage()"/><br/>Profile
                            </div>
                        </td>
                        <td style="width:17%">
                            <div style="padding-top:5px">
                                <img src="img/Cab.png" style="height:20px;" onclick="MyBookings()"/><br/>Bookings
                            </div>
                            
                        </td>
                        <td style="width:17%">
                            <div style="padding-top:5px">
                                <img src="img/History1.png" style="height:20px;" onclick="bookedHistory()"/><br/>History
                            </div>
                            
                        </td>
                        <td style="width:17%">
                            <div style="padding-top:5px">
                                <img src="img/feedback.png" style="height:20px;" onclick="feedBack()"/><br/>Feedback
                            </div>
                        </td>
                        <td style="width:17%">
                            <div style="padding-top:5px">
                                <img src="img/logout.png" style="height:20px;" onclick="logout()"/><br/>Logout
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
    </body>
</html>
